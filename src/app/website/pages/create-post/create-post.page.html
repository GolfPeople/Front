<ion-header class="ion-text-center">
  <ion-toolbar>
    <ion-title>
      <h2>
        <img src="../../../../assets/icon/create-post.png" alt="" /> crear
        publicacion
      </h2>
    </ion-title>
    <ion-buttons slot="start">
      <ion-button color="primary" shape="round" (click)="goBack()">
        <!-- <img src="../../../../assets/icon/back-link.png" alt="" /> -->
        <ion-icon slot="start" name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="content">
  <ion-row class="ion-justify-content-center ion-align-items-center">
    <div class="pick-image-container">
      <!-- <div class="button-container"> -->
      <input
        type="file"
        #fileInput
        (change)="uploadFile($event)"
        accept="image/*,video/*"
        hidden="true"
        multiple="true"
      />
      <input
        type="file"
        #fileInputVideo
        (change)="uploadFile($event)"
        hidden="true"
        multiple="true"
        accept="video/*;capture=camcorder"
      />
      <ion-button
        *ngIf="!backgroundImages.length"
        class="select-button"
        expand="block"
        (click)="selectImageSource()"
      >
        <img src="../../../../assets/icon/camera.png" alt="" />
      </ion-button>
      <!-- </div> -->
      <p
        *ngIf="!backgroundImages.length"
        class="text ion-text-center ion-margin-bottom"
      >
        ¿Alguna foto/vídeo que quieras compartir con la comunidad?
      </p>
      <swiper
        *ngIf="backgroundImages.length > 0"
        [pagination]="{
          dynamicBullets: true
        }"
        #swiper
      >
        <ng-template
          *ngFor="let image of backgroundImages;index as i"
          swiperSlide
        >
          <img [src]="image" class="picture" alt="" />

          <ion-button
            class="delete-button"
            color="danger"
            (click)="removeImage(i)"
            shape="outline"
          >
            X
          </ion-button>
        </ng-template>
      </swiper>
      <ion-button
        *ngIf="backgroundImages.length"
        class="add-image-button"
        (click)="selectImageSource()"
        expand="full"
      >
        Agregar imagen extra
      </ion-button>
      <!-- <swiper *ngIf="videos.length > 0" #swiper>
        <ng-template *ngFor="let video of videos" swiperSlide>
        </ng-template>
      </swiper> -->
      <!-- <div class="video-container">
        <video
          class="video"
          #video
          autoplay
          playsinline
          muted
          [hidden]="!isRecording"
        ></video>

        <div id="fullscreen" slot="fixed"></div>

        <ion-list *ngIf="!isRecording">
          <ion-item *ngFor="let video of videos" (click)="play(video)" tappable>
            {{video}}
          </ion-item>
        </ion-list>

       

        <ion-buttons slot="fixed">
          <ion-button (click)="isRecording ? stopRecord() : recordVideo()">
            <ion-icon [name]="isRecording ? 'stop' : 'videocam'"></ion-icon>
          </ion-button>
        </ion-buttons>
      </div> -->
    </div>

    <div class="footer">
      <p class="text">Añade un comentario a tu publicaión</p>
      <ion-textarea
        type="text"
        inputmode="text"
        [maxlength]="2000"
        class="text"
        [formControl]="textArea"
        placeholder="Escribe algo..."
      >
      </ion-textarea>
    </div>

    <form>
      <ion-list>
        <ion-item class="ion-align-items-center hashtags-input">
          <ion-label position="floating">
            <!-- <p>Agregar hashtags</p> -->
            Agregar hashtags
          </ion-label>
          <ion-input
            type="text"
            placeholder="Hashtags"
            (ionChange)="hashtag($event)"
            [formControl]="hashtagsInput"
          >
          </ion-input>
          <ion-button class="hashtag-button" slot="end" (click)="addHashtags()">
            <ion-icon name="add"></ion-icon>
          </ion-button>
        </ion-item>
        <ion-row>
          <!-- <ion-col *ngFor="let hashtag of hashtags" size="4"> -->
          <div *ngFor="let hashtag of hashtags" class="hashtags">
            <p>#{{ hashtag }}</p>
            <a (click)="removeHashtag(hashtag)">X</a>
          </div>
          <!-- </ion-col> -->
        </ion-row>
        <ion-item class="tags-input">
          <ion-label position="floating">
            <img class="geo" src="../../../../assets/icon/tag.png" alt="" />
            Etiqueta a tus amigos
          </ion-label>
          <ion-input
            type="text"
            placeholder="tags"
            (ngModelChange)="tag($event)"
            [formControl]="tagsInput"
          ></ion-input>
        </ion-item>
        <ion-list lines="none">
          <ion-item
            (click)="addTag(user.name, user.profile.user_id)"
            *ngFor="let user of users$ | async"
          >
            <ion-avatar slot="start">
              <img [src]="user.profile.photo" />
            </ion-avatar>
            <ion-label>{{user.name}}</ion-label>
          </ion-item>
        </ion-list>
        <ion-row class="tags-row" *ngIf="tags.length">
          <!-- <ion-col *ngFor="let tag of tags" size="4"> -->
          <div *ngFor="let tag of tags" class="hashtags">
            <p>@{{ tag }}</p>
            <a (click)="removeTag(tag)">X</a>
          </div>
          <!-- </ion-col> -->
        </ion-row>
        <ion-item class="ion-no-padding">
          <ion-label class="addressInput-label">
            <img
              class="tag"
              src="../../../../assets/icon/geolocation.png"
              alt=""
            />
          </ion-label>
          <img
            class="tag"
            src="../../../../assets/icon/geolocation.png"
            alt=""
          />
          <input
            class="addressInput"
            type="text"
            placeholder=" Ubicación"
            [(ngModel)]="userAddress"
            name="location"
            ngx-google-places-autocomplete
            (onAddressChange)="handleAddressChange($event)"
          />
        </ion-item>

        <!-- <div class="data-input">
          <img class="geo" src="../../../assets/icon/geolocation.png" alt="" />

          <input
            type="text"
            name="license"
            placeholder=" Ubicación"
            (ngModel)="userAddress"
            [formControl]="address"
            ngx-google-places-autocomplete
            (onAddressChange)="handleAddressChange($event)"
          />
        </div> -->
        <br />
      </ion-list>

      <ion-button
        [disabled]="blobArrayData.length === 0"
        (click)="onSubmit(textArea.value, blobArrayData, userAddress)"
        type="submit"
        class="next-button"
        shape="round"
      >
        PUBLICAR
      </ion-button>
    </form>
    <!-- </div> -->
  </ion-row>
</ion-content>
